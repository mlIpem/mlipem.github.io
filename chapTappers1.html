<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Two finger tappers – dynamic system | Exploring music interactions, with R</title>
<meta name="author" content="Marc Leman">
<meta name="description" content="This chapter deals with mutual influences while interacting. For example, two subjects perform a timing task while seeing each other performing this timing task differently. Are the performances...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 7 Two finger tappers – dynamic system | Exploring music interactions, with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://www.ugent.be/chapTappers1.html">
<meta property="og:image" content="https://www.ugent.be/images/cover.png">
<meta property="og:description" content="This chapter deals with mutual influences while interacting. For example, two subjects perform a timing task while seeing each other performing this timing task differently. Are the performances...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Two finger tappers – dynamic system | Exploring music interactions, with R">
<meta name="twitter:description" content="This chapter deals with mutual influences while interacting. For example, two subjects perform a timing task while seeing each other performing this timing task differently. Are the performances...">
<meta name="twitter:image" content="https://www.ugent.be/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Lato-0.4.9/font.css" rel="stylesheet">
<link href="libs/Roboto_Mono-0.4.9/font.css" rel="stylesheet">
<link href="libs/Montserrat-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-99618359-1', 'auto');
      ga('send', 'pageview');

    </script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VDC2S0ZNH5"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VDC2S0ZNH5');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h2>
        <a href="index.html" title="">Exploring music interactions, with R</a>
      </h2>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="chapTheory.html"><span class="header-section-number">1</span> Theory</a></li>
<li><a class="" href="chapModelling.html"><span class="header-section-number">2</span> Modelling</a></li>
<li><a class="" href="chapListener.html"><span class="header-section-number">3</span> Listener</a></li>
<li><a class="" href="chapDancer.html"><span class="header-section-number">4</span> Dancer</a></li>
<li><a class="" href="chapViolinist.html"><span class="header-section-number">5</span> Violin player</a></li>
<li><a class="" href="chapExoskeletons.html"><span class="header-section-number">6</span> Two violin players</a></li>
<li><a class="active" href="chapTappers1.html"><span class="header-section-number">7</span> Two finger tappers – dynamic system</a></li>
<li><a class="" href="chapTappers2.html"><span class="header-section-number">8</span> Two finger tappers</a></li>
<li><a class="" href="chapConclusion.html"><span class="header-section-number">9</span> Conclusion</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.ugent.be/mleman/ExploringMusicInteractionsWithR">View book source <i class="fab fa-gitlab"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chapTappers1" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Two finger tappers – dynamic system<a class="anchor" aria-label="anchor" href="#chapTappers1"><i class="fas fa-link"></i></a>
</h1>
<p>This chapter deals with mutual influences while interacting.
For example, two subjects perform a timing task while seeing each other performing this timing task differently.
Are the performances affecting each other, in terms of timing?
How would this mutual influence work? And why?</p>
<p>To analyse data about two persons interacting with each other, previous studies used methods such as cross-correlation, cross-recurrence analysis, quantification analysis, delay-coupled oscillators, among others<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;For a review, see Demos &amp;amp; Palmer, 2023. For an approach based on Kuramoto models, see Heggli et al., 2019).&lt;/p&gt;"><sup>22</sup></a>.
Our approach is inspired by <em>compartmental models</em> in which a state of units (subjects and metronomes) is changed by a flow among them<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;See &lt;a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology" class="uri"&gt;https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology&lt;/a&gt;, and Gesmann, M., and Morris, J. (2020) via &lt;a href="https://www.casact.org/sites/default/files/2021-02/compartmental-reserving-models-gesmannmorris0820.pdf" class="uri"&gt;https://www.casact.org/sites/default/files/2021-02/compartmental-reserving-models-gesmannmorris0820.pdf&lt;/a&gt;.&lt;/p&gt;'><sup>23</sup></a>. The goal is to identify that flow and find the parameters that govern the flow among the units. The parameters then explain and predict what happens.
It’s a cool idea but is it feasible?</p>
<p>In this chapter we also introduce Stan<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;See &lt;a href="https://mc-stan.org" class="uri"&gt;https://mc-stan.org&lt;/a&gt;&lt;/p&gt;'><sup>24</sup></a>, the probabilistic programming language underneath the R-package <code>brms</code>. We show how to program in Stan, in order to calculate a regression with a dynamic system as predictor.</p>
<p>The code is contained in:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"Code/chapAll_00_Initialization.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"Code/chapAll_01_Functions.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"Code/chapTappers/chapTappers_02_Simulation.R"</span><span class="op">)</span></span>
<span><span class="co">#source("Code/chapTappers/chapTappers_04_Modelling.R")</span></span>
<span><span class="co"># source("Code/chapTappers/chapTappers_05_ModelPlotting.R")</span></span>
<span><span class="co"># source("Code/chapTappers/chapTappers_06_Contrasts.R")</span></span>
<span><span class="co"># source("Code/chapTappers/chapTappers_07_ContrastPlotting.R")</span></span></code></pre></div>
<div id="theory-4" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Theory<a class="anchor" aria-label="anchor" href="#theory-4"><i class="fas fa-link"></i></a>
</h2>
<p>The theoretical background for this chapter is based on two principles: entrainment and dynamic systems.</p>
<div id="entrainment-1" class="section level3 unnumbered">
<h3>Entrainment<a class="anchor" aria-label="anchor" href="#entrainment-1"><i class="fas fa-link"></i></a>
</h3>
<p>First consider entrainment, or rhythmic entrainment. It can be defined as adaptation of timing, due to influences.
Here we study mutual influences, that is, entrainment in persons interacting with each other.
Entrainment is probably a factor that facilitates self-augmented interactions (see chapter <a href="chapTheory.html#chapTheory">1</a>).
It probably works as an <em>automatic</em> adaptation of collaborative activities towards a joint goal.
Its power may be huge, even having an emotional effect on humans involved in such activities.</p>
<p>Here, the key idea is to focus on entrainment and timing.
In demonstrating the near inevitability of entrainment under controlled circumstances, Rosso et al. (2024) created an <em>incongruency</em> in the feedback for controlling actions. It was done by creating conditions in which hearing and seeing inform our timing differently. Rosso et al. (2024) collected super-interesting data which we want to use in the next chapter. Before being able to use those data, we ask ourselves here how entrainment can be captured by a dynamic system.</p>
</div>
<div id="dynamic-system" class="section level3 unnumbered">
<h3>Dynamic system<a class="anchor" aria-label="anchor" href="#dynamic-system"><i class="fas fa-link"></i></a>
</h3>
<p>In fact, entrainment can be understood as a principle that tends to solve incongruent feedback for actions. Entrainment would lead to more congruent perception due to an adaptation of your actions that cause those perceptions. From that viewpoint, it’s of interest to consider a dynamic framework of understanding.</p>
<p>The idea to capture entrainment in terms of a dynamic system is challenging, because human behavior is complicated and the details of action-perception mechanisms leading to entrainment are specific in each individual, and far from known. So, how should we deal with this?</p>
<p>Well, the <em>dynamic systems approach</em> assumes that the interaction is ruled by higher-level parameters that matter for the interaction. Therefore, at that level, a reduction to the underlying action-perception mechanisms is not necessary because the behavior can be globally described. Accordingly, each unit involved in the interaction can be handled a black box whose inputs and outputs are known (or estimated) without knowing how the black box functions. In order words, we drop reductionism and adopt a more holistic perspective. Ultimately, both approaches may be integrated.
But let’s see how far we get with the holistic perspective.</p>
</div>
</div>
<div id="drifting-metronomes" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Drifting metronomes<a class="anchor" aria-label="anchor" href="#drifting-metronomes"><i class="fas fa-link"></i></a>
</h2>
<p>The <em>drifting metronomes</em> paradigm, developed in (Rosso et al., 2021, 2023), is a clever way to uncover entrainment, by controlling for incongruency. Here is how it works in detail.</p>
<p>Two subjects engage in synchronized tapping while listening to a metronome through headphones. The metronomes are slightly detuned in tempo, so that their phase is drifting. In particular, one metronome tics every 600 ms, while the other tics every 610 ms. Initially, the metronomes start ticking together (in-phase), but as time evolves, the tics become wider apart (out-phasing), eventually reaching an anti-phase state before their ticking comes closer in time again (in-phasing). When the cycle is completed, the metronomes have one tic exactly together. One complete outphasing and inphasing cycle takes <span class="math inline">\(36.6\)</span> seconds (<span class="math inline">\(600 * 610/ 10\)</span>). The subjects are asked to perform 10 such cycles in a row during one performance. They are instructed to follow the metronome they hear through the headphones.</p>
<p>The conditions of interest are: (i) not seeing each other and (ii) seeing each other.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;In the original experiment, there are 4 conditions. The two other conditions control the perspective of looking. Using VR, subjects see their own arm ticking from a second perspective, or they see the partner’s arm ticking as their own arm. Here we don’t consider these swapping conditions. Rather, we focus on the modality (hearing, and hearing+seeing)&lt;/p&gt;"><sup>25</sup></a></p>
<p>Rosso et al. (2023) found that the subjects’ tapping behavior was influenced by seeing each other tapping, despite the instruction to follow their own metronome. In other words, visual coupling between the individuals led to an entrainment effect on tapping behavior, even if the task implied anti-entrainment (or resistence to entrainment). This suggests that incongruent visual cues from the partner’s tapping influenced the synchronization between the subjects can be particularly strong, overriding the intended synchronization with the metronome they heard.</p>
<p>Our interest here is to offer a causal explanation of this phenomenon at the level of a phase flow, or change in timing among subjects. Our goal is to build a dynamic system that would predict the entrainment, using a few control parameters that covern the causal flow among interacting units.</p>
<div id="causality" class="section level3 unnumbered">
<h3>Causality<a class="anchor" aria-label="anchor" href="#causality"><i class="fas fa-link"></i></a>
</h3>
<p>The type of modelling suggests a <em>causal</em> level at which tapping/ticking is basically understood in terms of the <em>coupling strength</em>, and (if any), <em>phase delay</em>, among persons and metronomes involved. Conceptually speaking, this approach is very different from smooth regression, where modelling is based on a basis expansion using many splines. Here, the number of parameters is limited and the parameters have a straightforward physically interpretation in terms of attention and time. Moreover, all the knowledge is in the dynamics of the causal flow. We don’t need to go deeper into the subcomponents of our interacting units. We don’t model oscillators!
The dynamics pops up from (the less well understood) action-perception mechanisms that characterize the timing of the interacting units, and this dynamics is described at that higher level in which <em>coupling strength</em> and <em>phase delay</em> have a physical meaning.</p>
<p>The only restriction is that we cannot measure the <em>coupling strength</em> nor the <em>phase delay</em> directly.
Rather we have to infer these values from the data.</p>
</div>
<div id="approach" class="section level3 unnumbered">
<h3>Approach<a class="anchor" aria-label="anchor" href="#approach"><i class="fas fa-link"></i></a>
</h3>
<p>The development of the dynamical system, and the regression model, implies several steps which we sumarize in figure <a href="chapTappers1.html#fig:chapTappers1framework">7.1</a>:</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers1framework"></span>
<img src="Figures/chapTappers_20230626_ODEanalysis.jpg" alt="Methodological approach (see text for explanation)" width="100%"><p class="caption">
FIGURE 7.1: Methodological approach (see text for explanation)
</p>
</div>
<ul>
<li><p>Block 1 defines the dynamic system (ODE-system) and the regression (ODE-regression). The causal flow among interacting units is defined by coupling strength (K) and phase delay (D) parameters. The regression estimates the value of these parameters using data.</p></li>
<li><p>Block 2 aims at validating the regression model with simulated tic and tap data, in which parameters K and D are defined in order to generate these data. The goal is to retrieve the parameters from the simulated data. The parameters used for generating data and the parameters obtained from estimation should correspond.</p></li>
<li><p>Block 3 then applies the regression model to real human tapping data. The goal is to estimate the parameters and generate the process that generates the data. At this point we can contrast the parameters for seeing versus non-seeing conditions and check whether they are different.</p></li>
</ul>
<p>This chapter has a focus on Block 1 and 2, while the next chapter has a focus on Block 3.</p>
<!-- To implement the model, Stan 2.26.1 is used. The calculations are performed on a dedicated server running R version 4.3.0 (2023-04-21) and R-Studio Server 2023.6.0.421 on Ubuntu 22.04.2 LTS. The hardware configuration of the server includes a dual AMD Epyc 74F3 CPU with a total of 48 cores (96 threads), 128 GB (8x16GB) ECC DDR4 RAM, and an Nvidia RTX 3090TI graphics card. The simulations are set up in R. The R-package `doParallel` is used for parallel processing of ODE-regression models. The R-package `rstan` is used as an interface to the Stan engine. -->
</div>
</div>
<div id="dynamic-system-1" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Dynamic system<a class="anchor" aria-label="anchor" href="#dynamic-system-1"><i class="fas fa-link"></i></a>
</h2>
<p>Let us start by defining the dynamic system in the context of the drifting metronomes paradigm.
It should contain four units: two metronomes to synchronize with and two subjects interacting.
Accordingly, the dynamic system can be described by units and arrows, as shown in figure <a href="chapTappers1.html#fig:chapTappers2ODEsystem">7.2</a>.</p>
<p>Metronome 1, subject 1, metronome 2 and subject 2 are represented as units <span class="math inline">\(m1,s1,m2\)</span> and <span class="math inline">\(s2\)</span> and
their coupling is represented by arrows pointing from one unit to another unit. An arrow from <span class="math inline">\(s1\)</span> pointing to <span class="math inline">\(m1\)</span> means that subject 1 is coupled to metronome 1, which is described by a combination of coupling strength and phase delay.
The arrow show that each subject is coupled to the own metronome, and to the other subject.</p>
<p>We follow the convention that the arrows point in the direction where the influence comes from. Accordingly, each subject points to the own metronome and to the other subject.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers2ODEsystem"></span>
<img src="Figures/chapTappers_odepredictor.jpg" alt="Dynamic system" width="75%"><p class="caption">
FIGURE 7.2: Dynamic system
</p>
</div>
<div id="coupling-parameters" class="section level3 unnumbered">
<h3>Coupling parameters<a class="anchor" aria-label="anchor" href="#coupling-parameters"><i class="fas fa-link"></i></a>
</h3>
<p>Each arrow is defined by two parameters: coupling strength and phase delay.</p>
<p>The <em>coupling strength</em> has the prefix <span class="math inline">\(k\)</span>. Its value ranges from 0 to 1, where a value of 0 indicates no coupling, and a value of 1 indicates full coupling. The coupling strength <span class="math inline">\(ks1m1\)</span> captures how strongly <span class="math inline">\(s1\)</span> is coupled to <span class="math inline">\(m1\)</span> and thus, how strongly <span class="math inline">\(m1\)</span> is affecting the tapping of <span class="math inline">\(s1\)</span>.</p>
<p>A very important feature of this model is that the coupling parameters are constrained by the fact that, in one subject, all coupling parameters always sum to <span class="math inline">\(1\)</span>. In other words: <span class="math inline">\(1 = ks1m1 + ks1s2\)</span>.</p>
<p>The rationale for this constraint is that a subject has limited attention resources (between 0 and 1) that define the coupling. Accordingly, the attention devoted to <span class="math inline">\(s2\)</span> is at the cost of the attention devoted to <span class="math inline">\(m1\)</span>. Therefore, attention to <span class="math inline">\(m1\)</span> and/or <span class="math inline">\(s2\)</span> works as a system of communicating vessels, there is a constant volume to be distributed over two focus points.</p>
<p>Accordingly, we can represent the coupling strength by the length of the arrows, as suggested in figure <a href="chapTappers1.html#fig:chapTappers2ODEsystem2">7.3</a>.
In the left block the subjects devote all attention to their own metronome (<span class="math inline">\(ks1m1 = ks2m2 = 1\)</span>). It would be a typical situation in the condition where subjects <em>hear</em> the metronome and <em>don’t see</em> each other.
In the right block, the subjects divide attention partly to the metronome, partly to the partner.
It would be a typical situation in the condition where subjects <em>hear</em> the metronome and <em>see</em> each other.
The figure suggests that <span class="math inline">\(s1\)</span> has more attention to the own metronome than to the partner (say, <span class="math inline">\(ks1m1 = .7\)</span> and <span class="math inline">\(ks1s2 = 1-.7 =.3\)</span>), while <span class="math inline">\(s2\)</span> has more attention to the partner than to the metronome (say, <span class="math inline">\(ks2m2 = .3\)</span> and <span class="math inline">\(ks2s1 = 1-.3 = .7\)</span>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers2ODEsystem2"></span>
<img src="Figures/chapTappers_odesystem2parts.jpg" alt="Assumed coupling strength parameters of the uncoupled and coupled condition" width="100%"><p class="caption">
FIGURE 7.3: Assumed coupling strength parameters of the uncoupled and coupled condition
</p>
</div>
<p>The <em>phase delay</em> has the prefix <span class="math inline">\(d\)</span> (figure <a href="chapTappers1.html#fig:chapTappers2ODEsystem">7.2</a>) and its value ranges from <span class="math inline">\(-\pi\)</span> to <span class="math inline">\(\pi\)</span>.
<!-- $-\frac{\pi}{2}$ to $\frac{\pi}{2}$.  -->
It specifies an average time lag over the entire outphasing-inphasing cycle of 36.6 seconds.
The phase delay can be interpreted as an average synchronization offset.
Stricly speaking it can be deleted from the model but introducing it gives more flexibility to the model.</p>
</div>
<div id="phase-and-phase-flow" class="section level3 unnumbered">
<h3>Phase and Phase flow<a class="anchor" aria-label="anchor" href="#phase-and-phase-flow"><i class="fas fa-link"></i></a>
</h3>
<p>The dynamic system describes the change of phase over time, of connected units in a network.
We focus on phase because we work with events (taps and tics ) occurring at fixed time intervals for metronomes, and varying time intervals for subjects. Each such time interval covers <span class="math inline">\(2\pi\)</span>. The phase is a proportion of <span class="math inline">\(2\pi\)</span>, and the dynamic system describes how much the phase changes over time in all units.
Note that phase increases continuously but it can be wrapped on a scale of <span class="math inline">\(2\pi\)</span>, in the interval <span class="math inline">\([0, 2\pi]\)</span>, or when rotated, in the interval <span class="math inline">\([-\pi,+\pi]\)</span>.</p>
<p>Let us now look in more detail at the change in phase among the components of the dynamic system.</p>
</div>
<div id="phase-flow-metronomes" class="section level3 unnumbered">
<h3>Phase flow metronomes<a class="anchor" aria-label="anchor" href="#phase-flow-metronomes"><i class="fas fa-link"></i></a>
</h3>
<p>The change in phase over time of the metronomes is notated as <span class="math inline">\(\dot{\theta}_{m}\)</span> or <span class="math inline">\(\frac{d\theta_m}{dt}\)</span>. It is the <em>eigen-frequency</em> in units of radians per second <span class="math inline">\([\frac{rad}{sec}]\)</span>. Accordingly, <span class="math inline">\(m1\)</span> runs through the ticking phase cycle (<span class="math inline">\(2\pi\)</span>) in <span class="math inline">\(.6 sec\)</span>, while <span class="math inline">\(m2\)</span> does it in <span class="math inline">\(.61 sec\)</span>. The metronomes will have a fixed phase cycle because there are no influences acting upon it. No outward pointing arrows. The dynamic equations are:</p>
<p><span class="math display">\[
\dot{\theta}_{m1} = \omega_{m1} =  \frac{2\pi}{.6}\\
\dot{\theta}_{m2} = \omega_{m2} =  \frac{2\pi}{.61}
\]</span></p>
</div>
<div id="phase-flow-subjects" class="section level3 unnumbered">
<h3>Phase flow subjects<a class="anchor" aria-label="anchor" href="#phase-flow-subjects"><i class="fas fa-link"></i></a>
</h3>
<p>The phase flow in subjects is a bit more demanding, due to outgoing arrows that represent influences.
The subjects will have a varying phase cycle due to influences.
The dynamic equations for <span class="math inline">\(s1\)</span> and <span class="math inline">\(s2\)</span> are:</p>
<p><span class="math display" id="eq:chapTappersequation1a">\[\begin{equation}
\begin{array}{rl}
\dot{\theta}_{s1} = &amp; \omega_{m1} + \\
&amp; ks1m1 \cdot sin(\theta_{m1} - \theta_{s1} + ds1m1) + \\
&amp; (1-ks1m1) \cdot sin(\theta_{s2} - \theta_{s1} + ds1s2)\\
\end{array}\\
\begin{array}{rl}
\dot{\theta}_{s2} = &amp; \omega_{m2} + \\
&amp; ks2m2 \cdot sin(\theta_{m2} - \theta_{s2} + ds2m2) +\\
&amp; (1-ks2m2) \cdot sin(\theta_{s1} - \theta_{s2} + ds2s1)\\
\end{array}
\tag{7.1}
\end{equation}\]</span></p>
<p>Let’s focus on <span class="math inline">\(s1\)</span>.
The subject is requested to follow <span class="math inline">\(m1\)</span> and therefore its eigen-frequency is set equal to the eigen-frequency of the own metronome.
When the subject is devoting all attention to <span class="math inline">\(m1\)</span>, then <span class="math inline">\(ks1m1 = 1\)</span> and the subject will tap in phase with the metronome, apart from a possible phase delay.
Ideally, there will be zero contribution from the second and third term on the right hand side of the equation. We keep that in mind.</p>
<p>When the subject is devoting some attention to <span class="math inline">\(s2\)</span>,
then <span class="math inline">\(ks1m1 &lt; 1\)</span> and an influence will be exerted.</p>
<p>We first consider the second term, which we simplify to
<span class="math display">\[sin(\theta_{m1} - \theta_{s1}).\]</span>
In the first part of the outphasing-inphasing cycle, <span class="math inline">\(s1\)</span> will be influenced by <span class="math inline">\(s2\)</span> and therefore the phase difference <span class="math inline">\(\theta_{m1s1} = \theta_{m1} - \theta_{s1}\)</span> will be increasing over time until it reaches a maximum at <span class="math inline">\(\theta_{m1s1} = \frac{\pi}{2}\)</span>. At that point, the pulling force will be such that the phase of <span class="math inline">\(s1\)</span> comes back to the phase of <span class="math inline">\(m1\)</span>. In the second part of the outphasing-inphasing cycle, the phase difference is decreasing and we have a minimum (<span class="math inline">\(-1\)</span>) at <span class="math inline">\(\theta_{m1s1} = \frac{3\pi}{2}\)</span>.</p>
<p>Next, consider the third term, simplified as:
<span class="math display">\[sin(\theta_{s2} - \theta_{s1}).\]</span>
In the first part of the outphasing-inphasing cycles, <span class="math inline">\(s2\)</span> is tapping slower than <span class="math inline">\(s1\)</span> and the phase difference <span class="math inline">\(\theta_{s2s1} = \theta_{s2} - \theta_{s1}\)</span> will be descreasing. It will be increasing in the second part. A minimum will appear at <span class="math inline">\(\theta_{s2s1} = \frac{\pi}{2}\)</span>, and a maximum at <span class="math inline">\(\theta_{s2s1} = \frac{3\pi}{2}\)</span>.</p>
<p>In other words, <span class="math inline">\(m1\)</span> and <span class="math inline">\(s2\)</span> pull in the opposite direction and due to outphasing and inphasing of <span class="math inline">\(s2\)</span>, one may expect that, typically, the anti-phase zero-crossing point will be more delayed by <span class="math inline">\(s2\)</span> than by <span class="math inline">\(m1\)</span>. The more it is slowed down, the later that zero-crossing point will occur in a outphasing-inphasing cycle.</p>
<p>Since both sinusoids add, the curve will become asymmetrical both in time and in amplitude. Don’t forget that <span class="math inline">\(sin(.)\)</span> is first multiplied by the coupling strength. With extreme parameter settings (e.g., <span class="math inline">\(ks1m1\)</span> &lt; .4) the zero-crossing effect disappears (see the examples below).</p>
<p>Finally, we also have to consider the effect of the phase delay parameters.
Since these parameters are constant over the entire outphasing-inphasing cycle, they affect the entire curve by a shift of all values.
This effect is also best illustrated by means of examples.</p>
</div>
<div id="understanding-the-dynamic" class="section level3 unnumbered">
<h3>Understanding the dynamic<a class="anchor" aria-label="anchor" href="#understanding-the-dynamic"><i class="fas fa-link"></i></a>
</h3>
<p>At this point it is instructive to consider phase flow using a simulation of the dynamic equation.
First we take the dynamic equations to define a differential equation function called <code>dydt.</code></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the differential equation do_dydt</span></span>
<span><span class="va">dydt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">parms</span><span class="op">)</span><span class="op">)</span>, <span class="op">{</span></span>
<span>    <span class="co">############################## dynamic system</span></span>
<span>    <span class="va">dm1</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1000</span><span class="op">/</span><span class="fl">600</span></span>
<span>    <span class="va">ds1</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1000</span><span class="op">/</span><span class="fl">600</span>  <span class="op">+</span> </span>
<span>          <span class="fl">.5</span><span class="op">*</span><span class="op">(</span><span class="va">ks1m1</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">-</span> <span class="va">s1</span> <span class="op">+</span> <span class="va">ds1m1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ks1m1</span><span class="op">)</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">s2</span> <span class="op">-</span> <span class="va">s1</span> <span class="op">+</span> <span class="va">ds1s2</span><span class="op">)</span> <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">dm2</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1000</span><span class="op">/</span><span class="fl">610</span></span>
<span>    <span class="va">ds2</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1000</span><span class="op">/</span><span class="fl">610</span>  <span class="op">+</span> </span>
<span>          <span class="fl">.5</span><span class="op">*</span><span class="op">(</span><span class="va">ks2m2</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">m2</span> <span class="op">-</span> <span class="va">s2</span> <span class="op">+</span> <span class="va">ds2m2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ks2m2</span><span class="op">)</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">s1</span> <span class="op">-</span> <span class="va">s2</span> <span class="op">+</span> <span class="va">ds2s1</span><span class="op">)</span> <span class="op">)</span></span>
<span>    <span class="co">############################## retrieve components for ds1</span></span>
<span>    <span class="va">ds1a</span> <span class="op">=</span> <span class="va">ks1m1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">m1</span> <span class="op">-</span> <span class="va">s1</span> <span class="op">+</span> <span class="va">ds1m1</span><span class="op">)</span></span>
<span>    <span class="va">ds1b</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ks1m1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">s2</span> <span class="op">-</span> <span class="va">s1</span> <span class="op">+</span> <span class="va">ds1s2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dm1</span>,<span class="va">ds1</span>,<span class="va">dm2</span>,<span class="va">ds2</span>,<span class="va">ds1a</span>,<span class="va">ds1b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The first four equations define the dynamic system as depicted in figure <a href="chapTappers1.html#fig:chapTappers2ODEsystem">7.2</a>.
Next we retrieve components that contribute to <span class="math inline">\(ds1\)</span>.
In fact, we re-calculate <span class="math inline">\(ks1m1* sin(m1 - s1 + ds1m1)\)</span> as <span class="math inline">\(ds1a\)</span> and
<span class="math inline">\((1-ks1m1)* sin(s2 - s1 + ds1s2)\)</span> as <span class="math inline">\(ds1b\)</span>.
We solve the equations numerically using the R-package <code>deSolve</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define time points</span></span>
<span><span class="va">dt</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">36.6</span>, by <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span>
<span><span class="co"># define initial state</span></span>
<span><span class="va">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fl">0</span>, s1 <span class="op">=</span> <span class="fl">0</span>, m2 <span class="op">=</span> <span class="fl">0</span>, s2 <span class="op">=</span> <span class="fl">0</span>, s1a <span class="op">=</span> <span class="fl">0</span>, s1b <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># define the parameters</span></span>
<span><span class="va">parm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>ks1m1 <span class="op">=</span> <span class="fl">.9</span>, ks2m2 <span class="op">=</span> <span class="fl">.7</span>, ds1m1 <span class="op">=</span> <span class="fl">0</span>, ds2m2 <span class="op">=</span> <span class="fl">0</span>, ds1s2 <span class="op">=</span> <span class="fl">0</span>, ds2s1 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># solve the ODE</span></span>
<span><span class="va">solution</span> <span class="op">&lt;-</span> <span class="fu">ode</span><span class="op">(</span>y <span class="op">=</span> <span class="va">state</span>, times <span class="op">=</span> <span class="va">time_points</span>, func <span class="op">=</span> <span class="va">dydt</span>, parms <span class="op">=</span> <span class="va">parm</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># calculate the phase change over time = instantaneous frequency</span></span>
<span><span class="va">solution</span> <span class="op">&lt;-</span> <span class="va">solution</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span></span>
<span>  dm1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ds1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  dm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ds2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ds1a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">s1a</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ds1b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">s1b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here is how the data frame looks like:</p>
<pre><code>## 'data.frame':    3661 obs. of  13 variables:
##  $ time: num  0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 ...
##  $ m1  : num  0 0.105 0.209 0.314 0.419 ...
##  $ s1  : num  0 0.105 0.209 0.314 0.419 ...
##  $ m2  : num  0 0.103 0.206 0.309 0.412 ...
##  $ s2  : num  0 0.103 0.206 0.309 0.412 ...
##  $ s1a : num  0.00 1.93e-09 1.15e-08 3.65e-08 8.34e-08 ...
##  $ s1b : num  0.00 -8.58e-07 -3.43e-06 -7.71e-06 -1.37e-05 ...
##  $ dm1 : num  NA 0.105 0.105 0.105 0.105 ...
##  $ ds1 : num  NA 0.105 0.105 0.105 0.105 ...
##  $ dm2 : num  NA 0.103 0.103 0.103 0.103 ...
##  $ ds2 : num  NA 0.103 0.103 0.103 0.103 ...
##  $ ds1a: num  NA 1.93e-09 9.61e-09 2.50e-08 4.69e-08 ...
##  $ ds1b: num  NA -8.58e-07 -2.57e-06 -4.28e-06 -5.99e-06 ...</code></pre>
<p>The solution comes with a time indicator, with phases <span class="math inline">\(m1, s1, m2, s2, s1a\)</span> and <span class="math inline">\(s1b\)</span>, and phase changes <span class="math inline">\(dm1, ds1, dm2, ds2, ds1a\)</span> and <span class="math inline">\(ds1b\)</span> - the prefix <span class="math inline">\(d\)</span> refers to the differential, not to the delay.</p>
<p>Note that in this example, the coupling strengths are defined as <span class="math inline">\(ks1m1 = .9, ks2m2 = .7\)</span> and delay parameters are set to zero.
However, it is more instructive to vary the coupling strengths in a systematic way to see what happens.
So let us have a look at <span class="math inline">\(s1a\)</span> and <span class="math inline">\(s1b\)</span>, the components that contribute to phase change in <span class="math inline">\(s1\)</span>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappersSol1"></span>
<img src="08_chapTappers_files/figure-html/chapTappersSol1-1.png" alt="Phase change in s1 due to competing influences of m1 and s2. The columns show five different values of ks1m1, the rows show two different values of ks2m2. The thick line is the average of the thin lines, representing instantaneous frequency (without the eigen-frequency)" width="100%"><p class="caption">
FIGURE 7.4: Phase change in s1 due to competing influences of m1 and s2. The columns show five different values of ks1m1, the rows show two different values of ks2m2. The thick line is the average of the thin lines, representing instantaneous frequency (without the eigen-frequency)
</p>
</div>
<p>The first row shows the phase change in <span class="math inline">\(s1\)</span>, with different values of <span class="math inline">\(ks1m1\)</span> and influences due to <span class="math inline">\(s2\)</span>, with <span class="math inline">\(ks2m2 = 1\)</span>. In second row shows the phase change in <span class="math inline">\(s1\)</span> with <span class="math inline">\(ks2m2 = .75\)</span>.</p>
<p>We see how the contrasting sinusoids for <span class="math inline">\(m1\)</span> and <span class="math inline">\(s2\)</span> (shown as thin lines) define the phase change (shown as thick line). The dotted vertical line marks the anti-phase time of the metronomes.
Note furthermore that when <span class="math inline">\(ks1m1 = .4\)</span> the curve has flipped. It marks the fact that the tapping is more in line with <span class="math inline">\(s2\)</span> than with the own <span class="math inline">\(s1\)</span>.
In a similar way, it is possible to calculate the change of phase for <span class="math inline">\(s2\)</span> based on the pulling to metronome and partner subject.</p>
<p>Next we show the phase change of both <span class="math inline">\(s1\)</span> and <span class="math inline">\(s2\)</span>.
In this graph we represent the inverse of the instantaneous frequency, known as <em>instantaneous period</em>, with period on the vertical axis. Accordingly, with <span class="math inline">\(ks1m1 = ks2m2 = 1\)</span>, subjects follow their metronomes and therefore the instantaneous period of their tapping is on 600 ms and 610 ms. Note that the blue curves (from <span class="math inline">\(s1\)</span>) are the reversed curves from those in figure <a href="chapTappers1.html#fig:chapTappersSol1">7.4</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappersSol2"></span>
<img src="08_chapTappers_files/figure-html/chapTappersSol2-1.png" alt="Instantaneous period of s1 and s2. The columns show five different values of ks1m1, the rows show two different values of ks2m2" width="100%"><p class="caption">
FIGURE 7.5: Instantaneous period of s1 and s2. The columns show five different values of ks1m1, the rows show two different values of ks2m2
</p>
</div>
<p>The figure reveals that the blue curves (from <span class="math inline">\(s1\)</span>) become slightly different when there is a mutual influence due to <span class="math inline">\(ks2m2 = .75\)</span>. We now see more clearly that the instantaneous period of <span class="math inline">\(s1\)</span> comes close to the instantaneous period of <span class="math inline">\(s2\)</span> when <span class="math inline">\(ks1m1 = .4\)</span> and <span class="math inline">\(ks1m1 = .2\)</span>.</p>
<p>Next, we shown the relative phase, rather than the instantaneous period.
However, as the phase is continuously increasing it is more practical to look at the phase relative to the metronome, for example by taking the phase of the metronome minus the phase of the subject. We rotate the axis such that the interval covers <span class="math inline">\([-\pi,+\pi]\)</span>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappersSol3"></span>
<img src="08_chapTappers_files/figure-html/chapTappersSol3-1.png" alt="Relative phase of s1 and s2. The columns show five different values of ks1m1, the rows show two different values of ks2m2" width="100%"><p class="caption">
FIGURE 7.6: Relative phase of s1 and s2. The columns show five different values of ks1m1, the rows show two different values of ks2m2
</p>
</div>
<p>This viewpoint is of interest when phase delays enter the picture.
The next figure shows the relative phase when <span class="math inline">\(ds1m1 = ds2m2 = 1\)</span>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappersSol4"></span>
<img src="08_chapTappers_files/figure-html/chapTappersSol4-1.png" alt="Relative phase of s1 and s2, with phase delay ds1m1 = ds2m2 = 1. The columns show five different values of ks1m1, the rows show two different values of ks2m2" width="100%"><p class="caption">
FIGURE 7.7: Relative phase of s1 and s2, with phase delay ds1m1 = ds2m2 = 1. The columns show five different values of ks1m1, the rows show two different values of ks2m2
</p>
</div>
<p>Note that the phase delay tends to shift the curve downward, implying anticipation, while similar figures appear, except at the beginning of the curves because at that point, we start our state at the zero position.</p>
<p>The examples reveal the complex character of the dynamical system. Despite the fact that it is composed of simple sinusoids, its final behavior can be rather surprising.</p>
</div>
<div id="general-specification" class="section level3 unnumbered">
<h3>General specification<a class="anchor" aria-label="anchor" href="#general-specification"><i class="fas fa-link"></i></a>
</h3>
<p>It is possible to generalize the dynamical system to more units, arranged in different constellations but we don’t go into that topic here.
Instead, we want to check whether this dynamic system is worth the effort.
But before we proceed, it may be of interest to generalize the above approach using equation <a href="chapTappers1.html#eq:chapTappersequation1">(7.2)</a>:</p>
<p><span class="math display" id="eq:chapTappersequation1">\[\begin{equation}
\frac{d\theta_{i}}{dt} = \omega_{i} + \sum_j K_{i,j} sin(\theta_{t,j} - \theta_{t,i} + D_{i,j}),~
with ~ \theta_i(0) = 0 \tag{7.2}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> is the phase,
<span class="math inline">\(i,j\)</span> is an index for elements in <span class="math inline">\(\left\{ m1,s1,s2,m2 \right\}\)</span>, and
<span class="math inline">\(\omega\)</span> is the instantaneous frequency, set as <span class="math inline">\(\omega_i = \frac{2\pi*}{.6}~[\frac{rad}{sec}]\)</span>, for <span class="math inline">\(i=1,2\)</span> and <span class="math inline">\(\omega_i = \frac{2\pi}{.61}~[\frac{rad}{sec}]\)</span> for <span class="math inline">\(i=3,4\)</span>.</p>
</div>
<div id="design-matrices" class="section level3 unnumbered">
<h3>Design matrices<a class="anchor" aria-label="anchor" href="#design-matrices"><i class="fas fa-link"></i></a>
</h3>
<p>The matrix <span class="math inline">\(K\)</span> contains the coupling parameters from rows (index <span class="math inline">\(i\)</span>) to columns (index <span class="math inline">\(j\)</span>), and the parameters are in the range <span class="math inline">\([0,1]\)</span>.
Accordingly, <span class="math inline">\(K(2,1) = K_{s1,m1} = ks1m1\)</span>.
The matrix <span class="math inline">\(D\)</span> contains the delay parameters in the range <span class="math inline">\([-\pi,\pi]\)</span>.</p>
<p>Matrices K and D are design matrices that define the dynamic system. Dots mean that no parameter is created. If a parameter is created (e.g. <span class="math inline">\(ks1m1\)</span>), then there are two possibilities: either that parameter gets a defined value and data can be generated with it, or the value of that parameter is estimated from given data. In this chapter, we’ll first define them, and then estimate them. We can then check whether the estimation is correctly done.</p>
<p><span class="math display">\[
K = \begin{matrix}   
&amp;m1~~~~~~~~~~s1~~~~~~~~~~m2~~~~~~~~~~s2\\
\begin{matrix}   
   &amp;m1 \\
   &amp;s1 \\
   &amp;m2 \\
   &amp;s2 \\
\end{matrix} &amp;
\begin{bmatrix}
. &amp;. &amp;. &amp;. \\
ks1m1 &amp;. &amp;. &amp;1-ks1m1 \\
. &amp;. &amp;. &amp;. \\
. &amp;1-ks2m2  &amp;ks2m2 &amp;.\\
\end{bmatrix}
\end{matrix}
\]</span></p>
<p><span class="math display">\[
D = \begin{matrix}   
&amp;m1~~~~~s1~~~~~m2~~~~~s2\\
\begin{matrix}   
   &amp;m1 \\
   &amp;s1 \\
   &amp;m2 \\
   &amp;s2 \\
\end{matrix} &amp;
\begin{bmatrix}
. &amp;. &amp;. &amp;. \\
ds1m1 &amp;. &amp;. &amp;. \\
. &amp;. &amp;. &amp;. \\
. &amp;.  &amp;ds2m2 &amp;.\\
\end{bmatrix}
\end{matrix}
\]</span></p>
</div>
</div>
<div id="simulating-phase-flow-dynamics" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Simulating phase flow dynamics<a class="anchor" aria-label="anchor" href="#simulating-phase-flow-dynamics"><i class="fas fa-link"></i></a>
</h2>
<p>Equation <a href="chapTappers1.html#eq:chapTappersequation1">(7.2)</a> is non-linear and therefore it is useful to explore it with simulations. We refer to a shiny application <a href="http://odetappers.shinyapps.io/odetappers2/">here</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;See &lt;a href="http://odetappers.shinyapps.io/odetappers2/" class="uri"&gt;http://odetappers.shinyapps.io/odetappers2/&lt;/a&gt;&lt;/p&gt;'><sup>26</sup></a>, which readers may explore.
Given the above explanation, we believe that the tool is self-explanatory.</p>
<!-- <iframe src="http://odetappers.shinyapps.io/odetappers2/" width="750" height="1000"></iframe> -->
</div>
<div id="generating-data" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Generating data<a class="anchor" aria-label="anchor" href="#generating-data"><i class="fas fa-link"></i></a>
</h2>
<p>Now that we have a dynamic system our goal is to generate tics and taps, in three steps:</p>
<ul>
<li><p>Continuous phase-function generation. The dynamic equations generate curves for each unit of the dynamic system. These curves, or <em>phase-functions</em>, represent the underlying ticking or tapping process, either as relative phase or as instantaneous frequency (and period) We consider generating a series of dynamic systems, defined by the parameters. For each dynamic system, we’ll get phase functions for each unit.</p></li>
<li><p>Extraction of event times. Using the generated phase-functions we can extract the time at which the phase-functions becomes a multiple of <span class="math inline">\(2\pi\)</span>. Those time instances correspond to tics or taps from metronomes and subjects.</p></li>
<li><p>Addition of tap time noise. Given the human variability in finger tapping tasks, it is possible to introduce some noise to the extracted tap times.</p></li>
</ul>
<p>These steps generate a dataset of discrete metronome tics and subject taps which will be used in a regression to retrieve the parameters that generated these tics and taps.</p>
<div id="constraints-in-parameters" class="section level3 unnumbered">
<h3>Constraints in parameters<a class="anchor" aria-label="anchor" href="#constraints-in-parameters"><i class="fas fa-link"></i></a>
</h3>
<p>Based on the <em>drifting metronomes</em> paradigm, in which subjects are asked to tap along with the metronome heard through their headphones, we assume that most subjects will indeed be able to adhere to their own metronome. This implies that the coupling strength <span class="math inline">\(ks1m1\)</span> and <span class="math inline">\(ks2m2\)</span> will be rarely &lt; .4 because in that case they actually follow the partner (as illustrated in the above figures). Furthermore, we assume for testing purposes that both subjects have the same distribution of coupling strength. Accordingly, we first generate coupling strength values for subject 1. Then we reshuffle these values and assign coupling strength values to subject 2.</p>
<p>Constraints in phase delays can be justified by studies showing that humans tend to anticipate to the beat.
At this point, however, we define the phase delay with the metronomes, and set the phase delay among subjects to zero.</p>
</div>
<div id="generate-phase-functions" class="section level3 unnumbered">
<h3>Generate phase-functions<a class="anchor" aria-label="anchor" href="#generate-phase-functions"><i class="fas fa-link"></i></a>
</h3>
<p>The phase-functions are then generated using parameters for coupling strength and phase delay using samples from the distributions shown in figure <a href="chapTappers1.html#fig:chapTappers4couplingdelay2">7.8</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers4couplingdelay2"></span>
<img src="08_chapTappers_files/figure-html/chapTappers4couplingdelay2-1.png" alt="Densities for coupling parameters $ks1m1$ and $ks2m2$, and delay parameters $ds1m1$ and $ds2m2$" width="65%"><p class="caption">
FIGURE 7.8: Densities for coupling parameters <span class="math inline">\(ks1m1\)</span> and <span class="math inline">\(ks2m2\)</span>, and delay parameters <span class="math inline">\(ds1m1\)</span> and <span class="math inline">\(ds2m2\)</span>
</p>
</div>
<p>The coupling strength parameters is based on a beta distribution. The phase delay is based on a skewed normal distribution, accounting for a small anticipation in <span class="math inline">\(ds1m1\)</span> and <span class="math inline">\(ds2m2\)</span>. This distribution allows for capturing the asymmetry and slight anticipation commonly observed in tapping behavior<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;See Repp and Su (2012) for a review of finger tapping and anticipation.&lt;/p&gt;"><sup>27</sup></a>
.</p>
<p>Table <a href="chapTappers1.html#tab:chapTappers5couplingdelay3">7.1</a> shows the parameters for 40 randomly generated dynamic systems.
The columns represent the number and the parameters <span class="math inline">\(ks1m1, ks2m2, ds1m1, ds2m2\)</span>.
Note that the first 20 dynamic systems, specified by these parameters, have zero phase delay, while the second 20 have the same coupling strength and a non-zero phase delay:</p>
<div class="inline-table"><table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:chapTappers5couplingdelay3">TABLE 7.1: </span>Parameters of 40 dynamic systems
</caption>
<thead><tr>
<th style="text-align:right;">
sim
</th>
<th style="text-align:right;">
ks1m1
</th>
<th style="text-align:right;">
ks2m2
</th>
<th style="text-align:right;">
ds1m1
</th>
<th style="text-align:right;">
ds2m2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
0.63
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
1.01
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
-0.12
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
1.01
</td>
</tr>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.58
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.51
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
0.56
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.70
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.76
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.70
</td>
</tr>
<tr>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
-0.24
</td>
</tr>
</tbody>
</table></div>
<p>The number of dynamic systems (n = 40) is purely arbitrary and conforms our practical concerns in keeping the regression calculations (to be done later) within a reasonable amount of time.</p>
<p>Given the parameters, we generate the dynamic systems using code similar to the ode-solver code shown above. However, the phase-functions are calculated at a high sampling rate of 10,000 samples per second in order to get precise time indications for tics and taps.</p>
</div>
<div id="extract-tics-and-taps" class="section level3 unnumbered">
<h3>Extract tics and taps<a class="anchor" aria-label="anchor" href="#extract-tics-and-taps"><i class="fas fa-link"></i></a>
</h3>
<p>For each unit, the time values are taken at multiples of <span class="math inline">\(2\pi\)</span>, using the phase-function calculated in the previous step.
The resulting data set, with rows <span class="math inline">\(n=1...N\)</span>, contains time, phases of metronomes and subjects, simulation number (= defined by the matrices) and reference unit, as illustrated in figure <a href="chapTappers1.html#tab:chapTappers6odePhi12view">7.2</a>.
For example, at time 0.6, metronome 1 (see column <code>names</code>) has produced a tick, and its phase (being <span class="math inline">\(6.283185\)</span>, or <span class="math inline">\(2pi\)</span>) is shown in column <code>phi_m1</code>.
At time 0.61, metronome 2 has produced a tic. Its phase (<span class="math inline">\(2\pi\)</span>) is shown in <code>phi_m2</code>.
At time 0.6006, subject 1 has produced a tap, as shown in <code>phi_s1</code>. The phase is close to <span class="math inline">\(2\pi\)</span>, but has a small acceptable peak extraction error.
And so on.</p>
<div class="inline-table"><table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:chapTappers6odePhi12view">TABLE 7.2: </span>Tappers data
</caption>
<thead><tr>
<th style="text-align:right;">
time
</th>
<th style="text-align:right;">
phi_m1
</th>
<th style="text-align:right;">
phi_s1
</th>
<th style="text-align:right;">
phi_m2
</th>
<th style="text-align:right;">
phi_s2
</th>
<th style="text-align:left;">
sim
</th>
<th style="text-align:left;">
names
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0.6000
</td>
<td style="text-align:right;">
6.283185
</td>
<td style="text-align:right;">
6.276223
</td>
<td style="text-align:right;">
6.180182
</td>
<td style="text-align:right;">
6.187058
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
metronome 1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6006
</td>
<td style="text-align:right;">
6.289468
</td>
<td style="text-align:right;">
6.282494
</td>
<td style="text-align:right;">
6.186363
</td>
<td style="text-align:right;">
6.193250
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
subject 1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6093
</td>
<td style="text-align:right;">
6.380575
</td>
<td style="text-align:right;">
6.373420
</td>
<td style="text-align:right;">
6.275975
</td>
<td style="text-align:right;">
6.283040
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
subject 2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6100
</td>
<td style="text-align:right;">
6.387905
</td>
<td style="text-align:right;">
6.380736
</td>
<td style="text-align:right;">
6.283185
</td>
<td style="text-align:right;">
6.290265
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
metronome 2
</td>
</tr>
<tr>
<td style="text-align:right;">
1.1999
</td>
<td style="text-align:right;">
12.565323
</td>
<td style="text-align:right;">
12.542819
</td>
<td style="text-align:right;">
12.359334
</td>
<td style="text-align:right;">
12.381545
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
metronome 1
</td>
</tr>
<tr>
<td style="text-align:right;">
1.2021
</td>
<td style="text-align:right;">
12.588362
</td>
<td style="text-align:right;">
12.565792
</td>
<td style="text-align:right;">
12.381995
</td>
<td style="text-align:right;">
12.404271
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
subject 1
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="adding-noise" class="section level3 unnumbered">
<h3>Adding noise<a class="anchor" aria-label="anchor" href="#adding-noise"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, having extracted the taps and tics , some noise is added to the time values.
The noise has the characteristic <span class="math inline">\(2\pi N(0, \sigma)\)</span>, with <span class="math inline">\(\sigma\)</span> defined as <span class="math inline">\(0.0045\)</span> [s].</p>
</div>
<div id="examples" class="section level3 unnumbered">
<h3>Examples<a class="anchor" aria-label="anchor" href="#examples"><i class="fas fa-link"></i></a>
</h3>
<p>Figure <a href="chapTappers1.html#fig:chapTappers7generatedODEsample1">7.9</a> shows the phase functions and the discrete taps of dynamic system 1, whose parameters were defined in the first row of table <a href="chapTappers1.html#tab:chapTappers5couplingdelay3">7.1</a>).
The parameters are indicated on top.
The top panel shows the relative phase of each subject tapping with respect to its associated metronome ticking.
The dotted vertical line indicates one completed outphasing-inphasing cycle. Three such cycles are shown.
The bottom panel shows the instantaneous periods of all units (subjects and metronomes).
Note that the metronomes form straight lines at 600 and 610 ms.</p>
<!-- ```{r echo=FALSE} -->
<!-- KD[c(1,21,3,23),] -->
<!-- ``` -->
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers7generatedODEsample1"></span>
<img src="Figures/chapTappers_ODEgeneratedData_DataNoisy_KDsample1.png" alt="Dynamic system 1. Generated phase-functions with tapping data" width="100%"><img src="Figures/chapTappers_ODEgeneratedData_DataNoisy_KDsample1_inst_period.png" alt="Dynamic system 1. Generated phase-functions with tapping data" width="100%"><p class="caption">
FIGURE 7.9: Dynamic system 1. Generated phase-functions with tapping data
</p>
</div>
<p>Note that the introduction of a delay results in an offset as shown in figure <a href="chapTappers1.html#fig:chapTappers8generatedODEsample21">7.10</a>. With the inclusion of delay lines in dynamic system 21, it can be observed that the two relative phase curves no longer overlap (compared to ODE-system 1) and that the relative phase of subject 2 is below zero, reflecting anticipation to metronome 2.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers8generatedODEsample21"></span>
<img src="Figures/chapTappers_ODEgeneratedData_DataNoisy_KDsample21.png" alt="Dynamic system 21. Generated phase-functions with tapping data" width="49%"><img src="Figures/chapTappers_ODEgeneratedData_DataNoisy_KDsample21_inst_period.png" alt="Dynamic system 21. Generated phase-functions with tapping data" width="49%"><p class="caption">
FIGURE 7.10: Dynamic system 21. Generated phase-functions with tapping data
</p>
</div>
<p>Next consider the parameters for ODE-system 26.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers8generatedODEsample21ip"></span>
<img src="Figures/chapTappers_ODEgeneratedData_DataNoisy_KDsample26.png" alt="Dynamic system 26. Generated phase-functions with tapping data" width="49%"><img src="Figures/chapTappers_ODEgeneratedData_DataNoisy_KDsample26_inst_period.png" alt="Dynamic system 26. Generated phase-functions with tapping data" width="49%"><p class="caption">
FIGURE 7.11: Dynamic system 26. Generated phase-functions with tapping data
</p>
</div>
<p>The coupling parameters in dynamic system 26 result in subject 2 being more strongly coupled to subject 1, causing a positive bias in the relative phase of subject 2 towards subject 1. Conversely, subject 1 is strongly coupled to its own metronome and is less influenced by subject 2, resulting in a relatively constant relative phase over time. A similar behavior is actually reflected in the instantaneous period representation.</p>
<p>Additionally, it is important to note that the dynamic system is constrained to start at <span class="math inline">\(0 [rad]\)</span>. As indicated by the dashed red line, at the beginning of the second de-phasing/in-phasing cycle, the phase deviates from <span class="math inline">\(0 [rad]\)</span> but the dynamics over cycles becomes more stable (cf. cycle 2 and cycle 3). Note that the dashed red line marks the end of the first cycle.</p>
<p>These observations highlight the intricate dynamics and deviations from perfect synchrony in the tapping process, influenced by the coupling parameters, delay lines, and initial conditions of the dynamic system.
Using the interactive tool <a href="http://odetappers.shinyapps.io/odetappers2/">odetappers2</a>, these figures can be replicated by setting the parameters accordingly.</p>
</div>
</div>
<div id="regression-with-dynamic-system" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Regression with dynamic system<a class="anchor" aria-label="anchor" href="#regression-with-dynamic-system"><i class="fas fa-link"></i></a>
</h2>
<p>After having specified the dynamic system, and how discrete tap data can be extracted from the generated phase-functions, we now turn our attention to regression.
The objective is to estimate parameters of the dynamic system using the data, and predict the phase function based on observed discrete taps.
If this works, we have a super cool regression model with a dynamical system as predictor.</p>
<div id="data-3" class="section level3 unnumbered">
<h3>Data<a class="anchor" aria-label="anchor" href="#data-3"><i class="fas fa-link"></i></a>
</h3>
<p>Let us first define how the dataset, which we created, is gives as input to the regression.
It’s is a list of times and names at which tics/taps occur, notated as <span class="math inline">\(\theta_n = \theta_{t,i}\)</span>, with <span class="math inline">\(n=1,2,3...\)</span> indicating a row having <span class="math inline">\(i\)</span> as index for a unit (<span class="math inline">\(\left\{ m1,s1,s2,m2 \right\}\)</span>), and <span class="math inline">\(t\)</span> as time at which the tics/taps occur
The dataset is shown in table <a href="chapTappers1.html#tab:chapTappers6odePhi12view">7.2</a>, where <code>time</code> and <code>names</code> have been selected.</p>
<div class="inline-table"><table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:chapTappersInData">TABLE 7.3: </span>Simulated tappers data
</caption>
<thead><tr>
<th style="text-align:right;">
time
</th>
<th style="text-align:left;">
names
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0.6000
</td>
<td style="text-align:left;">
metronome 1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6006
</td>
<td style="text-align:left;">
subject 1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6093
</td>
<td style="text-align:left;">
subject 2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6100
</td>
<td style="text-align:left;">
metronome 2
</td>
</tr>
<tr>
<td style="text-align:right;">
1.1999
</td>
<td style="text-align:left;">
metronome 1
</td>
</tr>
<tr>
<td style="text-align:right;">
1.2021
</td>
<td style="text-align:left;">
subject 1
</td>
</tr>
</tbody>
</table></div>
<p>These times mark a tic/tap and therefore, the phase at that time instance is <span class="math inline">\(2\pi = 0 [rad]\)</span>, indicating the start of a new phase cycle that lasts until the next tic/tap.
For computational purposes, the tics/taps will have to be represented as phase on a rotated scale, from <span class="math inline">\([-\pi,+\pi]\)</span>.</p>
</div>
<div id="equation" class="section level3 unnumbered">
<h3>Equation<a class="anchor" aria-label="anchor" href="#equation"><i class="fas fa-link"></i></a>
</h3>
<p>The regression is then defined by a fitting based on:</p>
<p><span class="math display">\[\begin{equation}
\theta_n \sim f(\eta_n, \kappa)
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\theta_n\)</span> being the response at row <span class="math inline">\(n\)</span>, containing the time information at phase <span class="math inline">\(2\pi\)</span> or <span class="math inline">\(0 [rad]\)</span>.
<span class="math inline">\(f\)</span> is a von-Mises distribution, with mean <span class="math inline">\(\eta_n\)</span>, and precision <span class="math inline">\(\kappa\)</span>, realizing a mapping to the circular representation of phase in <span class="math inline">\(\theta_n\)</span>.</p>
<p><span class="math inline">\(\eta_n\)</span> is the outcome of an ODE-solver <span class="math inline">\(Z\)</span> up to the time indicated in row <span class="math inline">\(n\)</span>. Modulo <span class="math inline">\(2\pi\)</span> (<code>fmod</code>) is used to prevent an undefined growing phase value:</p>
<p><span class="math display">\[
\eta_n = fmod(Z(t_n;\Theta),2\pi).
\]</span>
The ODE-solver <span class="math inline">\(Z\)</span> returns successive phases estimates for each unit <span class="math inline">\(i\)</span> as defined by a set of parameters <span class="math inline">\(\Theta\)</span></p>
<p><span class="math display">\[
\Theta = (\theta_i(0),K_{i,j}, D_{i,j})
\]</span>
with
<span class="math inline">\(\theta_{m1,m2}(0) = 0\)</span> and <span class="math inline">\(\theta_{s1,s2}(0)\)</span> to be estimated.
Obviously, parameters in the design matrices K and D are also estimated.
Finally, the solution of the ODE-solver, which gives the phase value up to <span class="math inline">\(t_n=T\)</span>, can be specified as
<span class="math display">\[
\\
\begin{aligned}
&amp;\theta_{t_n &gt; 0,i} =  \theta_i(0) + \int_{t&gt;0}^{T} \left[ \omega_{i} + \sum_{j=1}^4 K_{i,j} sin(\theta_{t,j} - \theta_{t,i} + D_{i,j}) \right]~ dt &amp;\\
&amp;\theta_i(0) =  0&amp;\\
\end{aligned}
\]</span></p>
</div>
<div id="priors" class="section level3 unnumbered">
<h3>Priors<a class="anchor" aria-label="anchor" href="#priors"><i class="fas fa-link"></i></a>
</h3>
<p>The priors for the parameters in K and D are defined using previous available knowledge.
As subjects are requested to follow their own metronome, the prior for the coupling strength parameter obeys a beta distribution with a peak towards 1. Accordingly, beta is specified as <span class="math inline">\(beta(19,2)\)</span>.
Phase delay parameters are unknown but we assume that they are normal distributed with standard deviation 0.5.
<code>Kappa</code> is defined with a <span class="math inline">\(lognormal(.1,.15)\)</span>.
Finally, the initial phases of <span class="math inline">\(s1\)</span> and <span class="math inline">\(s2\)</span> are defined to occur in the neighborhood of zero, with <span class="math inline">\(normal(.0,.15)\)</span>.</p>
<!-- & dss &\sim &normal(.2,.1) &\text{Prior for delay among s1 and s2,} [-\frac{\pi}{2},\frac{\pi}{2}]\\ -->
<p><span class="math display">\[
\begin{aligned}
&amp; ks1m1 &amp;\sim &amp;beta(19,2) &amp;\text{Prior for coupling strength s1 to m1, range: [0,1] }\\
&amp; ks2m2 &amp;\sim &amp;beta(19,2) &amp;\text{Prior for coupling strength s2 to m2, [0,1]  }\\\\
&amp; ds1m1 &amp;\sim &amp;normal(.0,.5) &amp;\text{Prior for phase delay s1 to m1},[-\pi,\pi]\\
&amp; ds2m2 &amp;\sim &amp;normal(.0,.5) &amp;\text{Prior for phase delay s2 to m2}, [-\pi,\pi]\\
&amp; ds1s2 &amp;\sim &amp;normal(.0,.5) &amp;\text{Prior for phase delay s1 to s2}, [-\pi,\pi]\\
&amp; ds2s1 &amp;\sim &amp;normal(.0,.5) &amp;\text{Prior for phase delay s2 to s1}, [-\pi,\pi]\\\\
&amp; \kappa &amp;\sim &amp;lognormal(0.1,1.0) &amp;\text{Prior for precision} \\\\
&amp; \theta_{s1}(0) &amp;\sim &amp;normal(.0,.15) &amp;\text{Prior for initial phase of s1} \\
&amp; \theta_{s2}(0) &amp;\sim &amp;normal(.0,.15) &amp;\text{Prior for initial phase of s2} \\
\end{aligned}
\]</span></p>
</div>
</div>
<div id="running-stan" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Running Stan<a class="anchor" aria-label="anchor" href="#running-stan"><i class="fas fa-link"></i></a>
</h2>
<p>We now turn to Stan, which we need in order to calculate the regression.
Stan is a probabilistic programming language used primarily for statistical modeling and Bayesian inference. It provides a flexible framework for specifying and fitting a wide range of statistical models, including linear regression, hierarchical models, time series models, and more complex models involving latent variables and hierarchical structures. In fact, the R-package <code>brms</code> translates lme4-syntax into Stan code, to run it on the Stan engine. In this book, Stan has been with us for a while but only indirectly, via <code>brms</code>. Here we program directly in Stan.</p>
<p>Recall that our objective is to assess the feasibility of retrieving the coupling parameters from the simulated data. Once we have the values of coupling parameters, we can compare the parameter estimates in terms of the posterior distributions.
In addition, we can also compare phase-functions, also known as posterior predictions.</p>
<p>To facilitate this evaluation, we randomly selected the third outphasing/inphasing cycle of the simulated data as input.</p>
<p>The input to Stan is a list containing number of observations (<code>n_times</code>), number of generated time instances (<code>n_gen_times</code>), initial time (<code>time0</code>), phase (<code>phase</code>), time at which the phase appears (<code>time</code>), generated time instances (<code>time_gen</code>), unit (<code>name_indicator</code>) (1=<span class="math inline">\(m1\)</span>, 2=<span class="math inline">\(s1\)</span>, 3= <span class="math inline">\(m2\)</span>, 4= <span class="math inline">\(s2\)</span>). This is how the list looks like:</p>
<pre><code>## List of 7
##  $ n_times        : int 487
##  $ n_gen_times    : num 100
##  $ time0          : num 0
##  $ phase          : num [1:487] 0 0 0 0 0 0 0 0 0 0 ...
##  $ time           : num [1:487] 0 0.0127 0.0177 0.5689 0.5895 ...
##  $ time_gen       : num [1:100] 0.0001 0.3698 0.7395 1.1092 1.4789 ...
##  $ names_indicator: int [1:487] 1 4 2 2 2 1 1 4 3 3 ...</code></pre>
<p>The call for the Stan function in R has the following specification:</p>
<p>Inside the Stan code, which the reader can retrieve from the code in <code>./Code/chapTappers</code>, the call to the ODE function is:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapTappers1.html#cb33-1" tabindex="-1"></a>...</span>
<span id="cb33-2"><a href="chapTappers1.html#cb33-2" tabindex="-1"></a>vector[<span class="dv">4</span>] omega[n_times] <span class="ot">=</span> <span class="fu">ode_rk45</span>(do_dt, y0, time0, time, ks1m1, ks2m2, ds1m1, ds2m2, ds1s2, ds2s1) ;</span>
<span id="cb33-3"><a href="chapTappers1.html#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="chapTappers1.html#cb33-4" tabindex="-1"></a>...</span>
<span id="cb33-5"><a href="chapTappers1.html#cb33-5" tabindex="-1"></a>  </span>
<span id="cb33-6"><a href="chapTappers1.html#cb33-6" tabindex="-1"></a> <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_times){</span>
<span id="cb33-7"><a href="chapTappers1.html#cb33-7" tabindex="-1"></a>     phase[n] <span class="sc">~</span> <span class="fu">von_mises</span>(<span class="fu">fmod</span>(omega[n,names_indicator[n]] <span class="sc">+</span> <span class="fu">pi</span>(), <span class="dv">2</span><span class="sc">*</span><span class="fu">pi</span>()) <span class="sc">-</span> <span class="fu">pi</span>(), kappa) ;</span>
<span id="cb33-8"><a href="chapTappers1.html#cb33-8" tabindex="-1"></a>   }</span></code></pre></div>
<p>The ODE-function is defined according to our dynamic system as:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapTappers1.html#cb34-1" tabindex="-1"></a>functions {</span>
<span id="cb34-2"><a href="chapTappers1.html#cb34-2" tabindex="-1"></a>  vector <span class="fu">do_dt</span>(real t, vector y,  real ks1m1, real ks2m2,  real ds1m1, real ds2m2,</span>
<span id="cb34-3"><a href="chapTappers1.html#cb34-3" tabindex="-1"></a>  real ds1s2, real ds2s1){</span>
<span id="cb34-4"><a href="chapTappers1.html#cb34-4" tabindex="-1"></a>    real pi600 <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pi</span>()<span class="sc">/</span>.<span class="dv">6</span>; <span class="sc">/</span><span class="er">/</span> Eigenfrequency s1, m1</span>
<span id="cb34-5"><a href="chapTappers1.html#cb34-5" tabindex="-1"></a>    real pi610 <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pi</span>()<span class="sc">/</span>.<span class="dv">61</span>;  <span class="sc">/</span><span class="er">/</span> Eigenfrequency s2, m2</span>
<span id="cb34-6"><a href="chapTappers1.html#cb34-6" tabindex="-1"></a></span>
<span id="cb34-7"><a href="chapTappers1.html#cb34-7" tabindex="-1"></a>    real dm1dt <span class="ot">=</span> pi600; </span>
<span id="cb34-8"><a href="chapTappers1.html#cb34-8" tabindex="-1"></a>    real ds1dt <span class="ot">=</span> pi600 <span class="sc">+</span> </span>
<span id="cb34-9"><a href="chapTappers1.html#cb34-9" tabindex="-1"></a>              .<span class="dv">5</span><span class="sc">*</span>( </span>
<span id="cb34-10"><a href="chapTappers1.html#cb34-10" tabindex="-1"></a>              ks1m1 <span class="sc">*</span> <span class="fu">sin</span>(y[<span class="dv">1</span>] <span class="sc">-</span> y[<span class="dv">2</span>] <span class="sc">+</span> ds1m1) <span class="sc">+</span> </span>
<span id="cb34-11"><a href="chapTappers1.html#cb34-11" tabindex="-1"></a>              (<span class="dv">1</span><span class="sc">-</span>ks1m1) <span class="sc">*</span> <span class="fu">sin</span>(y[<span class="dv">4</span>] <span class="sc">-</span> y[<span class="dv">2</span>] <span class="sc">+</span> ds1s2)  ); </span>
<span id="cb34-12"><a href="chapTappers1.html#cb34-12" tabindex="-1"></a>    real dm2dt <span class="ot">=</span> pi610;</span>
<span id="cb34-13"><a href="chapTappers1.html#cb34-13" tabindex="-1"></a>    real ds2dt <span class="ot">=</span> pi610 <span class="sc">+</span> </span>
<span id="cb34-14"><a href="chapTappers1.html#cb34-14" tabindex="-1"></a>              .<span class="dv">5</span><span class="sc">*</span>( </span>
<span id="cb34-15"><a href="chapTappers1.html#cb34-15" tabindex="-1"></a>              ks2m2 <span class="sc">*</span> <span class="fu">sin</span>(y[<span class="dv">3</span>] <span class="sc">-</span> y[<span class="dv">4</span>] <span class="sc">+</span> ds2m2) <span class="sc">+</span> </span>
<span id="cb34-16"><a href="chapTappers1.html#cb34-16" tabindex="-1"></a>              (<span class="dv">1</span><span class="sc">-</span>ks2m2) <span class="sc">*</span> <span class="fu">sin</span>(y[<span class="dv">2</span>] <span class="sc">-</span> y[<span class="dv">4</span>] <span class="sc">+</span> ds2s1)  ); </span>
<span id="cb34-17"><a href="chapTappers1.html#cb34-17" tabindex="-1"></a>    return <span class="fu">to_vector</span>([dm1dt,ds1dt,dm2dt,ds2dt]);</span>
<span id="cb34-18"><a href="chapTappers1.html#cb34-18" tabindex="-1"></a>  }</span>
<span id="cb34-19"><a href="chapTappers1.html#cb34-19" tabindex="-1"></a>}</span></code></pre></div>
<p>The phases are retrieved with:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="chapTappers1.html#cb35-1" tabindex="-1"></a>vector[<span class="dv">4</span>] phase_gen[n_gen_times] <span class="ot">=</span> <span class="fu">ode_rk45</span>(do_dt, y0, time0, time_gen, ks1m1, ks2m2, ds1m1, ds2m2, ds1s2, ds2s1) ;</span></code></pre></div>
<p>Basically, this defines the regression as implemented in Stan.
It’s rather compact and not more than half a page of code<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Admitted, it takes some effort to get into the philosophy of probabilistic programming. Our sources were the Stan manuals available at &lt;a href="https://mc-stan.org/users/documentation/" class="uri"&gt;https://mc-stan.org/users/documentation/&lt;/a&gt;), and the study of Bob Carpenter on the predator-pray population dynamics available at &lt;a href="https://mc-stan.org/users/documentation/case-studies/lotka-volterra-predator-prey.html" class="uri"&gt;https://mc-stan.org/users/documentation/case-studies/lotka-volterra-predator-prey.html&lt;/a&gt;&lt;/p&gt;'><sup>28</sup></a>.</p>
</div>
<div id="evaluation" class="section level2" number="7.8">
<h2>
<span class="header-section-number">7.8</span> Evaluation<a class="anchor" aria-label="anchor" href="#evaluation"><i class="fas fa-link"></i></a>
</h2>
<p>Having defined the dynamic system, having generated data with 40 dynamic systems, having set up the regression model, and having run 40 regression models in order to estimate the parameters of the 40 dynamic systems,
we are now ready to
devoted our attention to evaluation.</p>
<p>As mentioned, we have two options of evaluating the output of the regression.
The first option is to consider the posterior distributions of the estimated parameters.
The second option is to consider the posterior predictions, as phase-function.</p>
<div id="evaluating-the-posterior-distributions-of-parameters" class="section level3 unnumbered">
<h3>Evaluating the posterior distributions of parameters<a class="anchor" aria-label="anchor" href="#evaluating-the-posterior-distributions-of-parameters"><i class="fas fa-link"></i></a>
</h3>
<p>Here we look at the parameters of 40 fitted models.
Figure <a href="chapTappers1.html#fig:chapTappers12ODEfittedParametersKD">7.12</a> shows the posterior distributions (estimated mean and 95%CI), compared to designed parameters (cicles).</p>
<p>The top panel shows the coupling strengths of the 40 dynamic models tested.
White circles imply that there is no match of designed and estimated parameter values.
Recall that the designed K-parameters are exactly the same for models 1 to 20, and models 21 to 40.
The middle panel shows the phase delay to the metronome, which is zero in models 1 to 20 and randomly assigned in models 21 to 40. It seems that the match of K-parameters is somewhat less good when the phase delay is forced to be zero.
The bottom panel shows the phase delay to the partner. Overall, the values are rather small and around zero.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers12ODEfittedParametersKD"></span>
<img src="Figures/chapTappers_OverviewODE_fittedParametersKD.png" alt="Posterior distributions of fitted parameters, compared to designed parameters (cicles). Top: coupling strength. Middle: phase delay to metronome. Bottom: phase delay to partner" width="100%"><p class="caption">
FIGURE 7.12: Posterior distributions of fitted parameters, compared to designed parameters (cicles). Top: coupling strength. Middle: phase delay to metronome. Bottom: phase delay to partner
</p>
</div>
<!-- ```{r chapTappers13ODEfittedParametersD, echo=FALSE, fig.cap="(a) Posterior distributions of fitted delay parameters D, compared to defined D (cicles). (b) Error as the difference between the mean value of the posterior distribution (called: fitted value) and the designed value. The boxplot shows the 25%, 50%, and 75% quantiles", out.width='35%', fig.asp=.75, fig.align='center', fig.show = "hold"} -->
<!-- knitr::include_graphics(c("Figures/chapTappers_OverviewODE_fittedParametersD_13_july.png", -->
<!--                           "Figures/chapTappers_OverviewODE_fittedParametersErrorD_13_july.png")) -->
<!-- # \@ref(fig:chapTappers12ODEfittedParametersD) -->
<!-- ``` -->
<p>In table <a href="chapTappers1.html#tab:chapTappers15KDcompare3">7.4</a> we show the parameters of all models.</p>
<div class="inline-table"><table class="table table-striped" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:chapTappers15KDcompare3">TABLE 7.4: </span>Defined and fitted parameters of 40 dynamic systems.
Column names have the following coding convention:
Defined parameters are: <span class="math inline">\(k1 = ks1m1\)</span>, <span class="math inline">\(k2 = ks2m2\)</span>,
<span class="math inline">\(d1 = ds1m1\)</span>, <span class="math inline">\(d2 = ds2m2\)</span>, <span class="math inline">\(d3 = ds1s2\)</span>, <span class="math inline">\(d4 = ds2s1\)</span>.
Fitted parameters are: <span class="math inline">\(K1 = ks1m1\)</span>,
<span class="math inline">\(K2 = ks2m2\)</span>,
<span class="math inline">\(D1 = ds1m1\)</span>,
<span class="math inline">\(D2 = ds2m2\)</span>,
<span class="math inline">\(D3 = ds1s2\)</span>,
<span class="math inline">\(D4 = ds2s1\)</span>.
Differences are:
<span class="math inline">\(Kk1 = K1 - k1\)</span>,
<span class="math inline">\(Kk2 = K2 - k2\)</span>,
<span class="math inline">\(Dd1 = D1 - d1\)</span> and
<span class="math inline">\(Dd2 = D2 - d1\)</span>
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="6">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
defined
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="6">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
fitted
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
fitted - defined
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
sim
</th>
<th style="text-align:right;">
k1
</th>
<th style="text-align:right;">
k2
</th>
<th style="text-align:right;">
d1
</th>
<th style="text-align:right;">
d2
</th>
<th style="text-align:right;">
d3
</th>
<th style="text-align:right;">
d4
</th>
<th style="text-align:right;">
K1
</th>
<th style="text-align:right;">
K2
</th>
<th style="text-align:right;">
D1
</th>
<th style="text-align:right;">
D2
</th>
<th style="text-align:right;">
D3
</th>
<th style="text-align:right;">
D4
</th>
<th style="text-align:right;">
Kk1
</th>
<th style="text-align:right;">
Kk2
</th>
<th style="text-align:right;">
Dd1
</th>
<th style="text-align:right;">
Dd2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;border-right:1px solid;">
1
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;border-right:1px solid;">
0.94
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;border-right:1px solid;">
0.97
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;border-right:1px solid;">
-0.07
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
0.02
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
2
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;border-right:1px solid;">
0.76
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;border-right:1px solid;">
0.70
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;border-right:1px solid;">
-0.09
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;border-right:1px solid;">
-0.06
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;border-right:1px solid;">
-0.07
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
3
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;border-right:1px solid;">
0.81
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;border-right:1px solid;">
0.89
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;border-right:1px solid;">
-0.39
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;border-right:1px solid;">
0.07
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;border-right:1px solid;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
4
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;border-right:1px solid;">
0.70
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;border-right:1px solid;">
0.73
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;border-right:1px solid;">
-0.30
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.08
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
5
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;border-right:1px solid;">
0.62
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;border-right:1px solid;">
0.70
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;border-right:1px solid;">
0.16
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
0.07
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
6
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;border-right:1px solid;">
0.72
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;border-right:1px solid;">
0.74
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;border-right:1px solid;">
0.23
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;border-right:1px solid;">
0.02
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;border-right:1px solid;">
0.02
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
7
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;border-right:1px solid;">
0.61
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;border-right:1px solid;">
0.65
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;border-right:1px solid;">
0.11
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
8
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;border-right:1px solid;">
0.76
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;border-right:1px solid;">
0.79
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;border-right:1px solid;">
-0.09
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;border-right:1px solid;">
0.02
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
9
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;border-right:1px solid;">
0.50
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;border-right:1px solid;">
0.52
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
-0.13
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.02
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.09
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
10
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;border-right:1px solid;">
0.57
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;border-right:1px solid;">
0.64
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;border-right:1px solid;">
-0.30
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;border-right:1px solid;">
0.08
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;border-right:1px solid;">
0.07
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
11
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;border-right:1px solid;">
0.81
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;border-right:1px solid;">
0.81
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.35
</td>
<td style="text-align:right;border-right:1px solid;">
0.48
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;border-right:1px solid;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
12
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;border-right:1px solid;">
0.86
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;border-right:1px solid;">
0.87
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.08
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
13
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;border-right:1px solid;">
0.63
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;border-right:1px solid;">
0.61
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;border-right:1px solid;">
0.14
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
-0.02
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.01
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
14
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;border-right:1px solid;">
0.79
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;border-right:1px solid;">
0.82
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;border-right:1px solid;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;border-right:1px solid;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
15
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;border-right:1px solid;">
0.58
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;border-right:1px solid;">
0.64
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;border-right:1px solid;">
-0.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.06
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;border-right:1px solid;">
0.14
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
16
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;border-right:1px solid;">
0.57
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;border-right:1px solid;">
0.62
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;border-right:1px solid;">
0.06
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;border-right:1px solid;">
0.12
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
17
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;border-right:1px solid;">
0.85
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;border-right:1px solid;">
0.90
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;border-right:1px solid;">
-0.02
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
18
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;border-right:1px solid;">
0.88
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;border-right:1px solid;">
0.96
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;border-right:1px solid;">
-0.15
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;border-right:1px solid;">
0.09
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;border-right:1px solid;">
-0.04
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
19
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;border-right:1px solid;">
0.75
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;border-right:1px solid;">
0.83
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;border-right:1px solid;">
-0.31
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;border-right:1px solid;">
0.08
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
-0.05
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
20
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;border-right:1px solid;">
0.73
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;border-right:1px solid;">
0.71
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.07
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;border-right:1px solid;">
-0.02
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
21
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;border-right:1px solid;">
0.94
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;border-right:1px solid;">
0.94
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;border-right:1px solid;">
0.59
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;border-right:1px solid;">
-0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
22
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;border-right:1px solid;">
0.76
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;border-right:1px solid;">
0.78
</td>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.01
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
23
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;border-right:1px solid;">
0.81
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;border-right:1px solid;">
0.87
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;border-right:1px solid;">
-0.36
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;border-right:1px solid;">
0.08
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
24
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;border-right:1px solid;">
0.70
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;border-right:1px solid;">
0.74
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;border-right:1px solid;">
-0.29
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
25
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;border-right:1px solid;">
0.62
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;border-right:1px solid;">
0.67
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;border-right:1px solid;">
0.22
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
0.08
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
26
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;border-right:1px solid;">
0.72
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;border-right:1px solid;">
0.77
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
-0.17
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
27
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;border-right:1px solid;">
0.61
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;border-right:1px solid;">
0.60
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;border-right:1px solid;">
0.19
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
-0.01
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;border-right:1px solid;">
-0.05
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
28
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;border-right:1px solid;">
0.76
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;border-right:1px solid;">
0.79
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;border-right:1px solid;">
-0.01
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
29
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;border-right:1px solid;">
0.50
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;border-right:1px solid;">
0.54
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;border-right:1px solid;">
0.15
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.18
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
30
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;border-right:1px solid;">
0.57
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;border-right:1px solid;">
0.57
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
-0.01
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.01
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
31
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;border-right:1px solid;">
0.81
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;border-right:1px solid;">
0.78
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;border-right:1px solid;">
0.39
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
-0.03
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
-0.05
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
32
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;border-right:1px solid;">
0.86
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;border-right:1px solid;">
0.83
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;border-right:1px solid;">
-0.13
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
-0.03
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
-0.04
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
33
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;border-right:1px solid;">
0.63
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;border-right:1px solid;">
0.64
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.08
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.01
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;border-right:1px solid;">
-0.01
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
34
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;border-right:1px solid;">
0.79
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;border-right:1px solid;">
0.74
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;border-right:1px solid;">
0.15
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;border-right:1px solid;">
-0.06
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;border-right:1px solid;">
-0.01
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
35
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;border-right:1px solid;">
0.58
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;border-right:1px solid;">
0.64
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;border-right:1px solid;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;border-right:1px solid;">
0.06
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;border-right:1px solid;">
0.12
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
36
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;border-right:1px solid;">
0.57
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;border-right:1px solid;">
0.59
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;border-right:1px solid;">
0.05
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;border-right:1px solid;">
0.03
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.10
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
37
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;border-right:1px solid;">
0.85
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;border-right:1px solid;">
0.84
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.16
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;border-right:1px solid;">
-0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;color: red !important;">
38
</td>
<td style="text-align:right;color: red !important;">
0.86
</td>
<td style="text-align:right;border-right:1px solid;color: red !important;">
0.88
</td>
<td style="text-align:right;color: red !important;">
0.52
</td>
<td style="text-align:right;color: red !important;">
0.40
</td>
<td style="text-align:right;color: red !important;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;color: red !important;">
0
</td>
<td style="text-align:right;color: red !important;">
0.96
</td>
<td style="text-align:right;border-right:1px solid;color: red !important;">
0.88
</td>
<td style="text-align:right;color: red !important;">
0.51
</td>
<td style="text-align:right;color: red !important;">
0.46
</td>
<td style="text-align:right;color: red !important;">
0.12
</td>
<td style="text-align:right;border-right:1px solid;color: red !important;">
0.16
</td>
<td style="text-align:right;color: red !important;">
0.10
</td>
<td style="text-align:right;border-right:1px solid;color: red !important;">
0.01
</td>
<td style="text-align:right;color: red !important;">
-0.01
</td>
<td style="text-align:right;border-right:1px solid;color: red !important;">
0.06
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
39
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;border-right:1px solid;">
0.75
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;border-right:1px solid;">
0.79
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;border-right:1px solid;">
0.01
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.04
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;border-right:1px solid;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;border-right:1px solid;">
40
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;border-right:1px solid;">
0.73
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;border-right:1px solid;border-right:1px solid;">
0
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;border-right:1px solid;">
0.79
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;border-right:1px solid;">
0.10
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;border-right:1px solid;">
0.07
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;border-right:1px solid;">
0.01
</td>
</tr>
</tbody>
</table></div>
<p>Table <a href="chapTappers1.html#tab:chapTappers13ODEfittedParametersKDTable">7.5</a> gives a summary of the
error between designed and estimated parameters.
The columns show the mean of the absolute value of the errors,
the standard deviation of the absolute value of the errors,
lower boundary of 95% of the errors, upper boundary of 95% of the errors, phase delay (No, Yes) and parameter (K, D).
For K parameters the mean of the absolute value of the errors is 0.04 and its standard deviation is 0.03 (0.02 when phase delay is specified).
These values suggest that the error is about 3% of the coupling strength (having the interval <span class="math inline">\([0,1]\)</span>).
For D parameters the error is <span class="math inline">\(100* .10 / (2\pi) = 1.6 \%\)</span> of the phase delay (having the interval <span class="math inline">\([-\pi,+\pi]\)</span>).</p>
<div class="inline-table"><table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:chapTappers13ODEfittedParametersKDTable">TABLE 7.5: </span>Mean of absolute value of errors, standard deviation of absolute errors, and Q95 range of between designed and estimated compling strength K and phase deley D, without and with designed phase delay
</caption>
<thead><tr>
<th style="text-align:right;">
m_abs
</th>
<th style="text-align:right;">
sd_abs
</th>
<th style="text-align:right;">
Q95.l
</th>
<th style="text-align:right;">
Q95.u
</th>
<th style="text-align:left;">
phasedelay
</th>
<th style="text-align:left;">
parameter
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
K
</td>
</tr>
<tr>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
K
</td>
</tr>
<tr>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
D
</td>
</tr>
<tr>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
D
</td>
</tr>
</tbody>
</table></div>
<p>Overall, it can be concluded that the dynamic models are quite successful in retrieving the K and D parameters.
The dynamic model might be useful for real data.</p>
</div>
<div id="evaluating-the-posterior-predictions" class="section level3 unnumbered">
<h3>Evaluating the posterior predictions<a class="anchor" aria-label="anchor" href="#evaluating-the-posterior-predictions"><i class="fas fa-link"></i></a>
</h3>
<p>Here we look at the posterior predictions which we know already as phase-functions: either the relative phase is shown, or the instantaneous period is shown.
Such a comparison is more qualitative, showing pictures of designed phase-functions and fitted phase-functions.
Below are shown some examples:</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chapTappers16simFinal"></span>
<img src="Figures/chapTappers_sim_STAN_Final_5_jun_2024_1.png" alt="Dynamic systems 1 and 21. Left: Generated data (circles) and defined phase functions (dotted lines) versus fitted phase functions (full lines and gray band showing the mean and 95% confidence of the posterior predictions). The estimations cover one single tapping cycle, using cycle 3 of the generated data. Right: Instanteneous period of the fitted model" width="49%"><img src="Figures/chapTappers_sim_STAN_Final_5_jun_2024_1_InstPeriod.png" alt="Dynamic systems 1 and 21. Left: Generated data (circles) and defined phase functions (dotted lines) versus fitted phase functions (full lines and gray band showing the mean and 95% confidence of the posterior predictions). The estimations cover one single tapping cycle, using cycle 3 of the generated data. Right: Instanteneous period of the fitted model" width="49%"><img src="Figures/chapTappers_sim_STAN_Final_5_jun_2024_21.png" alt="Dynamic systems 1 and 21. Left: Generated data (circles) and defined phase functions (dotted lines) versus fitted phase functions (full lines and gray band showing the mean and 95% confidence of the posterior predictions). The estimations cover one single tapping cycle, using cycle 3 of the generated data. Right: Instanteneous period of the fitted model" width="49%"><img src="Figures/chapTappers_sim_STAN_Final_5_jun_2024_21_InstPeriod.png" alt="Dynamic systems 1 and 21. Left: Generated data (circles) and defined phase functions (dotted lines) versus fitted phase functions (full lines and gray band showing the mean and 95% confidence of the posterior predictions). The estimations cover one single tapping cycle, using cycle 3 of the generated data. Right: Instanteneous period of the fitted model" width="49%"><p class="caption">
FIGURE 7.13: Dynamic systems 1 and 21. Left: Generated data (circles) and defined phase functions (dotted lines) versus fitted phase functions (full lines and gray band showing the mean and 95% confidence of the posterior predictions). The estimations cover one single tapping cycle, using cycle 3 of the generated data. Right: Instanteneous period of the fitted model
</p>
</div>
</div>
</div>
<div id="discussion-3" class="section level2" number="7.9">
<h2>
<span class="header-section-number">7.9</span> Discussion<a class="anchor" aria-label="anchor" href="#discussion-3"><i class="fas fa-link"></i></a>
</h2>
<p>The error between <em>defined</em> and <em>estimated</em> coupling strength parameters is about 2% or less of the coupling strength scale, and there is no great difference in accuracy for coupling strengths with our without defined phase delay. Good news for further applications of this dynamic system approach.</p>
<p>However, several limitations and shortcomings of the evaluation should be mentioned as well.</p>
<p>First, the dynamic system assumes that attention is either devoted to the own metronome heard or to the other subject seen. One may question whether it is realistic. Perhaps human subjects get distracted by other events outside the timing task. Distraction is something that the model doesn’t capture.</p>
<p>Second, in the current model, the coupling strength in the model is fixed over time but it could be that human have a coupling strength that changes over time.</p>
<p>Finally, the modelling needs to accurately reflect the physical setup. A slightly different paradigm for studying rhythmic entrainment (e.g. with spontaneous tapping without metronomes) could require a careful adaptation of the dynamic system defined in this chapter.</p>
</div>
<div id="conclusion-6" class="section level2" number="7.10">
<h2>
<span class="header-section-number">7.10</span> Conclusion<a class="anchor" aria-label="anchor" href="#conclusion-6"><i class="fas fa-link"></i></a>
</h2>
<!-- In this and the following chapter, we show that dyadic tapping data, given the setup of the drifting metronomes paradigm, can be analysed with the help of a set of ordinal differential equations that define the dynamic model. Our goal is to estimate the parameters of these equations, in order to predict entrainment. This estimation is challenging due to the nonlinear nature of the model and its sensitivity to initialization.  -->
<p>In this chapter we studied entrainment as a dynamic system defined by network of timing units (metronomes and subjects) whose phase flow can be described by differential equations.
This dynamic system can generate phase-functions from which it is possible to extract discrete events, standing for tics and taps.</p>
<p>We then developed a regression model where the dynamic system is used as predictor for estimating the parameters that would generate tic and tap data. We used the designed tic and tap date as input to the regression model in order to estimate the parameters of the dynamic system.</p>
<p>Finally, the estimated parameters can be compared with the designed parameters, and the predicted phase-functions can be compared with the designed phase functions.</p>
<p>Overall, the non-linear regression modelling seems to offer a
valuable tool for acquiring insight about rhythmic entrainment in terms of causal dyadic interactions at the level of a phase flow.</p>
<!-- Further research focusing on different experimental paradigms, and application of the ODE-regression model on human data has the potential to contribute to a deeper understanding of sensorimotor synchronization in music-dance (e.g. Talebi et al., 2023), motor rehabilitation (Moumdjian et al., 2022), and other forms of human expression and empowerment, including biofeedback systems (Leman, 2016). -->
<!-- ## References -->
<!-- (for a comprehensive overview, refer to Demos & Palmer, 2023) -->
<!-- (e.g. Heggli et al., 2019) Kuramoto models -->
<!-- (see Repp and Su (2012) for a review of finger tapping and anticipation -->
<!-- (e.g. McElreath, 2020, Gelman et al., 2013) -->
<!-- , see a number of blogs listed at the end of this chapter -->
<!-- (Rosso et al., 2021, 2023) -->

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="chapExoskeletons.html"><span class="header-section-number">6</span> Two violin players</a></div>
<div class="next"><a href="chapTappers2.html"><span class="header-section-number">8</span> Two finger tappers</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <h2>Provide your feedback</h2>
    <!--<p>Now is a great time to provide feedback</p>-->
        <ul class="list-unstyled">
<!--<li><a href="https://forms.gle/nq9RmbxJyZXQgc948">Provide feedback (5 min)</a></li>--><li><a href="https://www.ugent.be/lw/kunstwetenschappen/ipem/en/services/asil">art and science interaction lab</a></li>
        </ul>
<hr>
<nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chapTappers1"><span class="header-section-number">7</span> Two finger tappers – dynamic system</a></li>
<li>
<a class="nav-link" href="#theory-4"><span class="header-section-number">7.1</span> Theory</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#entrainment-1">Entrainment</a></li>
<li><a class="nav-link" href="#dynamic-system">Dynamic system</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#drifting-metronomes"><span class="header-section-number">7.2</span> Drifting metronomes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#causality">Causality</a></li>
<li><a class="nav-link" href="#approach">Approach</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dynamic-system-1"><span class="header-section-number">7.3</span> Dynamic system</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#coupling-parameters">Coupling parameters</a></li>
<li><a class="nav-link" href="#phase-and-phase-flow">Phase and Phase flow</a></li>
<li><a class="nav-link" href="#phase-flow-metronomes">Phase flow metronomes</a></li>
<li><a class="nav-link" href="#phase-flow-subjects">Phase flow subjects</a></li>
<li><a class="nav-link" href="#understanding-the-dynamic">Understanding the dynamic</a></li>
<li><a class="nav-link" href="#general-specification">General specification</a></li>
<li><a class="nav-link" href="#design-matrices">Design matrices</a></li>
</ul>
</li>
<li><a class="nav-link" href="#simulating-phase-flow-dynamics"><span class="header-section-number">7.4</span> Simulating phase flow dynamics</a></li>
<li>
<a class="nav-link" href="#generating-data"><span class="header-section-number">7.5</span> Generating data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#constraints-in-parameters">Constraints in parameters</a></li>
<li><a class="nav-link" href="#generate-phase-functions">Generate phase-functions</a></li>
<li><a class="nav-link" href="#extract-tics-and-taps">Extract tics and taps</a></li>
<li><a class="nav-link" href="#adding-noise">Adding noise</a></li>
<li><a class="nav-link" href="#examples">Examples</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#regression-with-dynamic-system"><span class="header-section-number">7.6</span> Regression with dynamic system</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-3">Data</a></li>
<li><a class="nav-link" href="#equation">Equation</a></li>
<li><a class="nav-link" href="#priors">Priors</a></li>
</ul>
</li>
<li><a class="nav-link" href="#running-stan"><span class="header-section-number">7.7</span> Running Stan</a></li>
<li>
<a class="nav-link" href="#evaluation"><span class="header-section-number">7.8</span> Evaluation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#evaluating-the-posterior-distributions-of-parameters">Evaluating the posterior distributions of parameters</a></li>
<li><a class="nav-link" href="#evaluating-the-posterior-predictions">Evaluating the posterior predictions</a></li>
</ul>
</li>
<li><a class="nav-link" href="#discussion-3"><span class="header-section-number">7.9</span> Discussion</a></li>
<li><a class="nav-link" href="#conclusion-6"><span class="header-section-number">7.10</span> Conclusion</a></li>
</ul>
      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.ugent.be/mleman/ExploringMusicInteractionsWithR/blob/main/08_chapTappers.Rmd">View source <i class="fab fa-gitlab"></i></a></li>
          <li><a id="book-edit" href="https://github.ugent.be/mleman/ExploringMusicInteractionsWithR/edit/main/08_chapTappers.Rmd">Edit this page <i class="fab fa-gitlab"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Exploring music interactions, with R</strong>" was written by Marc Leman. It was last built on 2024-06-26.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
